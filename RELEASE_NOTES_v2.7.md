# –ì—Ä—è–≥-–±–æ—Ç v2.7: –ü–æ–∫—Ä–∞—â–µ–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Gemini API

## üöÄ –í–µ—Ä—Å—ñ—è: v2.7-gemini-enhanced
**–î–∞—Ç–∞ –≤–∏–ø—É—Å–∫—É**: 28 —á–µ—Ä–≤–Ω—è 2025

## üéØ –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

### ‚≠ê –°—É—á–∞—Å–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Gemini API v1beta
- –ü–æ–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –Ω–∞–π–æ—Å—Ç–∞–Ω—ñ—à–æ—ó –≤–µ—Ä—Å—ñ—ó Gemini API (v1beta)
- –°—É—á–∞—Å–Ω–∞ REST API —Å—Ö–µ–º–∞ –∑ —É—Å—ñ–º–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏
- –ö–æ–Ω—Ñ—ñ–≥—É—Ä–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è API —á–µ—Ä–µ–∑ `GEMINI_API_VERSION`

### üß† –†–æ–∑—É–º–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
- **System Instructions** - –∫–∞—Å—Ç–æ–º–Ω—ñ —Å–∏—Å—Ç–µ–º–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ —Ä–µ–∂–∏–º–∏** - normal, minimal, guidance, humor, clarification
- **Thinking Mode** - –ø–æ–∫—Ä–∞—â–µ–Ω—ñ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- **Safety Settings** - –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä–∏ –±–µ–∑–ø–µ–∫–∏ (4 –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó)

### ‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ç–∞ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å
- **Rate Limiting** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ (RPM)
- **–ö–µ—à—É–≤–∞–Ω–Ω—è** - —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è –∑ TTL
- **Exponential Backoff** - —Ä–æ–∑—É–º–Ω–µ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –ø–æ–º–∏–ª–æ–∫
- **–î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API

### üîß –ì–Ω—É—á–∫–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
- 25+ –Ω–æ–≤–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –≤ .env –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó (temperature, tokens, topP, topK)
- –ö–∞—Å—Ç–æ–º–Ω—ñ safety settings –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤

## üìã –ù–æ–≤—ñ —Ñ–∞–π–ª–∏ —Ç–∞ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### –ú–æ–¥—É–ª—ñ
- `bot/modules/gemini_enhanced.py` - –Ω–æ–≤–∏–π –æ—Å–Ω–æ–≤–Ω–∏–π –∫–ª—ñ—î–Ω—Ç API
- `bot/modules/gemini.py` - –æ–Ω–æ–≤–ª–µ–Ω–∏–π wrapper –¥–ª—è –∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ

### –¢–µ—Å—Ç–∏
- `test_integration_gemini.py` - —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏
- `test_api_version.py` - —Ç–µ—Å—Ç–∏ –≤–µ—Ä—Å—ñ—ó API

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- `GEMINI_ENHANCED_INTEGRATION.md` - –¥–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- `GEMINI_INTEGRATION_COMPLETION_REPORT.md` - –∑–≤—ñ—Ç –ø—Ä–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é
- `API_VERSION_UPDATE_REPORT.md` - –ø–æ—è—Å–Ω–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ–π API

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
- –û–Ω–æ–≤–ª–µ–Ω–∏–π `.env.example` –∑ —É—Å—ñ–º–∞ –Ω–æ–≤–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

## üîÑ –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å

### ‚úÖ –ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å
- –í–µ—Å—å —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ –ø—Ä–∞—Ü—é—î –±–µ–∑ –∑–º—ñ–Ω
- –í—Å—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–±–µ—Ä–µ–∂–µ–Ω—ñ
- –ü–ª–∞–≤–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –±–µ–∑ –ø–æ–ª–æ–º–æ–∫

### üÜï –ù–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
```python
# –¢–æ–Ω —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó
response = await gemini.process_message(message, tone_instruction="–ë—É–¥—å –≤–µ—Å–µ–ª–∏–º")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = await gemini.get_gemini_stats()

# –ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ enhanced client
from bot.modules.gemini_enhanced import get_client
client = await get_client()
```

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
```bash
# –û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
GEMINI_API_KEY=your_api_key_here
GEMINI_MODEL=gemini-2.5-flash
GEMINI_API_VERSION=v1beta

# System instructions
GEMINI_SYSTEM_INSTRUCTION="–í–∏ –¥—Ä—É–∂–µ–ª—é–±–Ω–∏–π —É–∫—Ä–∞—ó–Ω–æ–º–æ–≤–Ω–∏–π —á–∞—Ç-–±–æ—Ç"

# –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è
GEMINI_ENABLE_CACHE=true
GEMINI_RATE_LIMIT_RPM=60
```

### –†–æ–∑—à–∏—Ä–µ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- Temperature, max tokens, topP, topK
- Safety settings –¥–ª—è –≤—Å—ñ—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
- Thinking mode –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
- Structured output –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å—ñ—Ö —Ç–µ—Å—Ç—ñ–≤
python -m pytest test_integration_gemini.py -v

# –¢–µ—Å—Ç –≤–µ—Ä—Å—ñ—ó API
python test_api_version.py
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- ‚úÖ –ë–∞–∑–æ–≤–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- ‚úÖ –¢–æ–Ω —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ API
- ‚úÖ –í–µ—Ä—Å—ñ—è API v1beta
- ‚úÖ –ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å

## üéÅ –ì–æ—Ç–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

### –î–æ—Å—Ç—É–ø–Ω–æ –∑–∞—Ä–∞–∑
- –ü–æ–≤–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Gemini API v1beta
- System instructions —Ç–∞ safety settings
- Rate limiting —Ç–∞ –∫–µ—à—É–≤–∞–Ω–Ω—è
- Thinking mode
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ —Ä–µ–∂–∏–º–∏
- –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ –¥–æ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ
- Structured Output (JSON —Å—Ö–µ–º–∏)
- Multimodal (–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è/–∞—É–¥—ñ–æ)
- Streaming –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- Function calling

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç
1. –†–æ–∑–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö—ñ–≤ `gryag-bot-v2.7-gemini-enhanced-20250628.zip`
2. –°–∫–æ–ø—ñ—é–π—Ç–µ `.env.example` –≤ `.env`
3. –ó–∞–ø–æ–≤–Ω—ñ—Ç—å `TELEGRAM_BOT_TOKEN` —Ç–∞ `GEMINI_API_KEY`
4. –ó–∞–ø—É—Å—Ç—ñ—Ç—å: `python start.py`

### Docker
```bash
# –†–æ–∑–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö—ñ–≤
unzip gryag-bot-v2.7-gemini-enhanced-20250628.zip

# –ù–∞–ª–∞—à—Ç—É–π—Ç–µ .env
cp .env.example .env
# –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ .env –∑ –≤–∞—à–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d
```

## üîç –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è

### –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–æ—Ç–∞
1. **–ö—Ä–∞—â—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** - –∑–∞–≤–¥—è–∫–∏ system instructions —Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏–º —Ä–µ–∂–∏–º–∞–º
2. **–®–≤–∏–¥—à–∞ —Ä–æ–±–æ—Ç–∞** - –∫–µ—à—É–≤–∞–Ω–Ω—è –∑–º–µ–Ω—à—É—î –∑–∞—Ç—Ä–∏–º–∫–∏
3. **–°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å** - rate limiting –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é API
4. **–ë–µ–∑–ø–µ–∫–∞** - –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞–Ω—ñ safety settings

### –î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤
1. **–°—É—á–∞—Å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞** - –ø–æ–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ Gemini API
2. **–õ–µ–≥–∫–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** - –º–æ–¥—É–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
3. **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** - –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
4. **–¢–∏–ø—ñ–∑–∞—Ü—ñ—è** - –∫—Ä–∞—â–∏–π developer experience

## üêõ –í–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

- ‚úÖ –£—Ç–æ—á–Ω–µ–Ω–æ –≤–µ—Ä—Å—ñ—é API (—Ç–µ–ø–µ—Ä —á—ñ—Ç–∫–æ v1beta)
- ‚úÖ –î–æ–¥–∞–Ω–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –≤–µ—Ä—Å—ñ—ó API
- ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –≤–µ—Ä—Å—ñ–π
- ‚úÖ –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API —Ä–µ—Å—É—Ä—Å—ñ–≤

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –∑–º—ñ–Ω–∏

### –ù–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
```bash
GEMINI_API_VERSION=v1beta  # –ù–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ –¥–ª—è –≤–µ—Ä—Å—ñ—ó API
GEMINI_SYSTEM_INSTRUCTION="..."  # System instructions
# + 20+ —ñ–Ω—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
1. **Production**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ v1beta –¥–ª—è –≤—Å—ñ—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π
2. **–°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å**: –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å `GEMINI_RATE_LIMIT_RPM=50`
3. **–ö–µ—à**: –£–≤—ñ–º–∫–Ω—ñ—Ç—å `GEMINI_ENABLE_CACHE=true`
4. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**: –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ `/stats`

## üéâ –©–æ –¥–∞–ª—ñ

### –ú–∞–π–±—É—Ç–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
- Structured Output –¥–ª—è JSON –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- Multimodal –¥–ª—è –∑–æ–±—Ä–∞–∂–µ–Ω—å —Ç–∞ –∞—É–¥—ñ–æ
- Streaming –¥–ª—è –¥–æ–≤–≥–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- Vector databases –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–Ω–æ–≥–æ –ø–æ—à—É–∫—É

### –ü—ñ–¥—Ç—Ä–∏–º–∫–∞
- –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –≤ –∞—Ä—Ö—ñ–≤—ñ
- –ü—Ä–∏–∫–ª–∞–¥–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏
- Community –ø—ñ–¥—Ç—Ä–∏–º–∫–∞

---

**–ê—Ä—Ö—ñ–≤**: `gryag-bot-v2.7-gemini-enhanced-20250628.zip` (72.8 KB, 31 —Ñ–∞–π–ª)

**–°—Ç–≤–æ—Ä–µ–Ω–æ –∑ ‚ù§Ô∏è —Ç–∞ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—è–º–∏ –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —á–∞—Ç—ñ–≤** üá∫üá¶
