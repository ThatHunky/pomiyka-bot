# üéâ –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —á–∞—Ç—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ!

## ‚úÖ –©–æ –∑—Ä–æ–±–ª–µ–Ω–æ

–°–∏—Å—Ç–µ–º–∞ —Ä–æ–∑—É–º–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —á–∞—Ç—É –±—É–ª–∞ **—É—Å–ø—ñ—à–Ω–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞**. 

### –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:

üß† **–†–æ–∑—É–º–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Å–ø–∞–º—É**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏—è–≤–ª—è—î —Å–ø–∞–º (low/medium/high)
- –ó–º–µ–Ω—à—É—î –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –±–æ—Ç–∞ –ø—Ä–∏ –Ω–∞–¥–º—ñ—Ä–Ω—ñ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- –ú'—è–∫—ñ –∞–Ω—Ç–∏-—Å–ø–∞–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

üîß **–°—Ç–∏—Å–Ω–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É**
- –ó–±–µ—Ä—ñ–≥–∞—î –≤–∞–∂–ª–∏–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–∑–≥–∞–¥–∫–∏ –±–æ—Ç–∞, –ø–∏—Ç–∞–Ω–Ω—è)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–ø—Ç–∏–º—ñ–∑—É—î —Ä–æ–∑–º—ñ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- –ù–µ –≤—Ç—Ä–∞—á–∞—î –≤–∞–∂–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é

üìä **–ê–Ω–∞–ª—ñ–∑ —è–∫–æ—Å—Ç—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É**  
- –û—Ü—ñ–Ω—é—î –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω—ñ—Å—Ç—å —Ä–æ–∑–º–æ–≤–∏
- –ê–¥–∞–ø—Ç—É—î —Å—Ç–∏–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–æ —Å–∏—Ç—É–∞—Ü—ñ—ó
- –ù–∞–ø—Ä–∞–≤–ª—è—î —Ä–æ–∑–º–æ–≤—É –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ

‚öôÔ∏è **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ—Ä–µ–≥—É—î –¥–æ–≤–∂–∏–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- –ó–º—ñ–Ω—é—î —Å—Ç–∏–ª—å (minimal/concise/normal)
- –î–∞—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó Gemini

## üöÄ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è

### –ú–æ–¥—É–ª—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ:
- ‚úÖ `enhanced_behavior.py` - –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ä–æ–∑—É–º–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏
- ‚úÖ `main.py` - —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ `utils.py` - —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π FakeMessage
- ‚úÖ `gemini.py` - –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π

### –ù–æ–≤–∞ –≥–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è:
```python
from bot.modules.enhanced_behavior import process_message_with_smart_context

result = process_message_with_smart_context(
    message_text, chat_id, context, recent_messages
)
# –ü–æ–≤–µ—Ä—Ç–∞—î: should_respond, spam_analysis, context_quality, 
#           tone_instruction, recommendations, processed_context
```

## üìã –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### –ü—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ñ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ:
- –ë–æ—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —è–∫ –∑–∞–∑–≤–∏—á–∞–π
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ù–æ—Ä–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (200 —Å–∏–º–≤–æ–ª—ñ–≤)

### –ü—Ä–∏ —Å–ø–∞–º—ñ (medium):
- –ó–º–µ–Ω—à—É—î —à–∞–Ω—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤ 3 —Ä–∞–∑–∏
- –ö–æ—Ä–æ—Ç—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (100 —Å–∏–º–≤–æ–ª—ñ–≤)
- –°—Ç–∏–ª—å `concise`

### –ü—Ä–∏ —Å–ø–∞–º—ñ (high):
- –ó–º–µ–Ω—à—É—î —à–∞–Ω—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤ 10 —Ä–∞–∑—ñ–≤  
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (50 —Å–∏–º–≤–æ–ª—ñ–≤)
- –°—Ç–∏–ª—å `minimal`
- –ú–æ–∂–ª–∏–≤—ñ –∞–Ω—Ç–∏-—Å–ø–∞–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

### –ü—Ä–∏ –ø–æ–≥–∞–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ:
- –¢–æ–Ω `–Ω–∞–ø—Ä–∞–≤–ª—è—é—á–∏–π_–∂–∞—Ä—Ç`
- –ó–∞–ø–∏—Ç–∏ –Ω–∞ —É—Ç–æ—á–Ω–µ–Ω–Ω—è
- –°–ø—Ä–æ–±–∏ –Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ —Ä–æ–∑–º–æ–≤—É

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–°–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ—Å–Ω—É—é—á—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑ `.env`:

```env
BOT_SPAM_THRESHOLD=5          # –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å/—Ö–≤ –¥–ª—è —Å–ø–∞–º—É
BOT_SMART_REPLY_CHANCE=0.1    # –ë–∞–∑–æ–≤–∏–π —à–∞–Ω—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ  
BOT_CONTEXT_LIMIT=1000        # –õ—ñ–º—ñ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
BOT_MAX_CONTEXT_SIZE=10000    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä
```

## ‚úÖ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–í—Å—ñ —Ç–µ—Å—Ç–∏ —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω–æ:
- ‚úÖ –í–∏—è–≤–ª–µ–Ω–Ω—è —Å–ø–∞–º—É —Ç–∞ –∫–æ—Ä–µ–∫—Ü—ñ—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∏
- ‚úÖ –°—Ç–∏—Å–Ω–µ–Ω–Ω—è –≤–µ–ª–∏–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- ‚úÖ –ê–Ω–∞–ª—ñ–∑ —è–∫–æ—Å—Ç—ñ —Ä–æ–∑–º–æ–≤–∏  
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π
- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –æ—Å–Ω–æ–≤–Ω–∏–º –±–æ—Ç–æ–º

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ë–æ—Ç —Ç–µ–ø–µ—Ä –Ω–∞–±–∞–≥–∞—Ç–æ —Ä–æ–∑—É–º–Ω—ñ—à–∏–π:**

1. **–ù–µ —Å–ø–∞–º–∏—Ç—å** –≤ –∞–∫—Ç–∏–≤–Ω–∏—Ö —á–∞—Ç–∞—Ö
2. **–ó–±–µ—Ä—ñ–≥–∞—î –≤–∞–∂–ª–∏–≤–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç** –ø—Ä–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—ñ
3. **–ê–¥–∞–ø—Ç—É—î —Å—Ç–∏–ª—å** –¥–æ —Å–∏—Ç—É–∞—Ü—ñ—ó –≤ —á–∞—Ç—ñ
4. **–ù–∞–ø—Ä–∞–≤–ª—è—î —Ä–æ–∑–º–æ–≤—É** –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ
5. **–ó–±–µ—Ä—ñ–≥–∞—î –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** –ø—Ä–∏ –≤–µ–ª–∏–∫–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ

## üöÄ –ì–æ—Ç–æ–≤–æ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≥–æ—Ç–æ–≤–∞ —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –±–æ—Ç–∞ —è–∫ –∑–∞–≤–∂–¥–∏:

```bash
python bot/main.py
```

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º–µ –Ω–æ–≤—É —Ä–æ–∑—É–º–Ω—É —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–æ–±–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É! üéâ

---

**–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!** –ë–æ—Ç —Ç–µ–ø–µ—Ä –º–∞—î —Ä–æ–∑—É–º–Ω—É –æ–±—Ä–æ–±–∫—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —á–∞—Ç—É –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Å–ø–∞–º—É —Ç–∞ –Ω–æ–Ω—Å–µ–Ω—Å—É.
